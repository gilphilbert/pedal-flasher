<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>DIY FFB Firmware Flasher</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@4.19.0/css/xterm.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,700">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.min.css"></link>
        <link rel="stylesheet" href="theme.css"></link>

        <link rel="icon" href="../assets/favicon.ico" />
         <script src="https://cdn.jsdelivr.net/npm/xterm@4.19.0/lib/xterm.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.js"></script>
    </head>
    <body>
        <div class="section gray">
            <div class="container">
                <h1><img src="../assets/diy-ffb-pedal-logo.png" width="42" height="42" style="vertical-align: middle" crossorigin></img> Web Flasher</h1>
                <h4>Firmware flash tool for the <a href="https://github.com/ChrGri/DIY-Sim-Racing-FFB-Pedal">DIY FFB Pedal</a> project</h4>
            </div>
        </div>
        <div class="section">

            <div class="container">

                <div id="safariWarning" class="callout callout-danger">
                    <p class="title">Unsupported</p>
                    This tool is not supported on Safari Browser. Please use a Chromium-based brower (Chrome, Edge, Brave, etc.)
                </div>

                <div class="callout callout-info">
                    <p class="title">Get your board ready</p>
                    Start with the board unplugged. Hold the "Flash" or "Boot" button on the board and plug it in to this computer - the board is now ready to flash new firmware. Click the "Connect" button below.
                </div>
                <input class="button-primary" type="button" id="connectButton" value="Connect" />
                <input class="button-warning" type="button" id="disconnectButton" value="Disconnect" />

                <form>
                    <fieldset>

                        <label id="lblConnTo">Connected device: (none)</label>

                        <label for="boardType" id="lblBoardType">Board type:</label>
                        <select name="boardType" id="boardType">
                            <option value="control">Control Board</option>
                            <option value="bridge">Wireless Controller (Bridge)</option>
                        </select>

                        <label for="channel" id="lblChannel">Channel:</label>
                        <select name="channel" id="channel">
                            <option value="main" disabled>Stable (Recommended)</option>
                            <option value="dev">Development</option>
                        </select>

                        <label for="boardName" id="lblBoardName">Select a board:</label>
                        <select name="boardName" id="boardName"></select>

                        <label id="lblFirmwareVersion">Firmware version:</label>

                        <input class="button-primary" type="button" id="programButton" value="Flash Firmware" />

                        <div class="progress" id="progress">
                            <div class="bar" id="progressBar"></div>
                        </div>

                        <div class="callout callout-success" id="successNotice">
                            <p>Firmware flashed successfully</p>
                        </div>
                        <div class="callout callout-danger" id="failureNotice">
                            <p>Firmware flashing failed</p>
                            <p id="failureMessage"></p>
                        </div>

                        <div class="alert alert-danger alert-dismissible" id="alertDiv" style="display:none; margin-top:10px">
                            <a href="#" class="close" aria-label="close" onclick="$('.alert').hide()">&times;</a>
                            <span id="alertmsg"></span>
                        </div>

                    </fieldset>
                </form>

                <input class="button-outline" type="button" id="consoleButton" value="Show console" />
                <div id="terminal"></div>
            </div>
        </div>
        <script src="index.ts" type="module"></script>
    </body>
</html>
